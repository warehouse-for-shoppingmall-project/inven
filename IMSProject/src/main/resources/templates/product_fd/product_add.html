<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>상품 등록</title>
    <style>
        #product_title_table {
            width: 240px;
            display: inline-block;
            float: left;
        }

        #product_title_table input {
            width: 100px;
        }

        #product_title_table #file {
            width: 200px;
        }

        #product_title_table #manufacturing_date {
            width: 120px;
        }

        #product_detail_table {
            display: inline-table;
            width: 300px;
            /* float: right; */
        }

        #product_detail_table input {
            width: 70px;
        }

        #titleForm {
            font-weight: bold;
        }
    </style>
</head>

<body>
<h1>상품 등록하기</h1>
<div id="wrap">
    <!-- enctype : 파일 첨부 기능이 있다면 꼭 추가해라했음.. -->

    <br>

    <form name="titleForm" action="/prod/add" method="post" id="titleForm">
        <table>
            <tr>
                <th>상품 코드</th>
                <td>
                    <input type="text" name="product_code" placeholder="ex: CT001"><br>
                </td>
            </tr>
            <tr>
                <th>단가</th>
                <td>
                    <input type="number" name="unit_price" value="0">원
                </td>
            </tr>
            <tr>
                <th>공장 이름</th>
                <td>
                    <input type="text" name="make_factory" placeholder="제조사 명 입력">
                </td>
            </tr>
            <tr>
                <th>최종 수정일</th>
                <td>
                    <input type="date" name="final_update">
                </td>
            </tr>
            <tr>
                <th>제조 코드</th>
                <td>
                    <input type="number" name="make_code">
                </td>
            </tr>
            <tr>
                <th>파일</th>
                <td>
                    <input type="file" name="file" id="file">
                </td>
            </tr>
            <tr>
                <th>비고</th>
                <td>
                    <input type="text" name="etc">
                </td>
            </tr>
        </table>

        <table id="product_detail_table">
            <thead>
            <tr>
                <th>색상</th>
                <th>성별</th>
                <th>s</th>
                <th>m</th>
                <th>l</th>
                <th>xl</th>
                <th>free</th>
                <th>total</th>
                <th>제조날짜</th>
                <th><input type="button" value="+" id="addButton" onclick="addDetail()"></th>
            </tr>
            </thead>
            <tbody id="product_detail_tbody">

            <tr>
                <td><input type="text" name="color_name"></td>
                <td><select name="gender">
                    <option value="C">공용</option>
                    <option value="W">여자</option>
                    <option value="M">남자</option>
                </select></td>
                <td><input type="number" name="s"></td>
                <td><input type="number" name="m"></td>
                <td><input type="number" name="l"></td>
                <td><input type="number" name="xl"></td>
                <td><input type="number" name="free"></td>
                <td><input type="text" name="total" value="0" readonly></td>
                <td><input type="date" name="manufacture_day"></td>
            </tr>
            </tbody>
        </table>
        <br>


        <input type="submit" id="prodAdd" value="상품 등록">
    </form>

    <!-- end of outer form -->
</div>
<!-- end of wrap-->

<!-- 버튼 클릭 시 detail 테이블 열 추가 -->
<script>
    window.onload = function () {
        $('input[type=number]').val(0);
    }

    let product_detail_tbody = document.getElementById("product_detail_tbody");
    let rowName = ['s', 'm', 'l', 'xl', 'free', 'total'];
    let rowType = ['number', 'number', 'number', 'number', 'number', 'text'];

    function addDetail() {
        let row = product_detail_tbody.insertRow();

        //색상
        row.insertCell(0).innerHTML += '<input type="text" name="color_name">';
        //성별
        row.insertCell(1).innerHTML += '<select name="gender">'
            + '<option value="C">공용</option>'
            + '<option value="W">여자</option>'
            + '<option value="M">남자</option>' + '</select>';

        //사이즈(s~free), 총 수량
        for (let i = 0; i < rowName.length; i++) {
            row.insertCell(i + 2).innerHTML += '<input type="number" name="' + rowName[i] + '" value="0">';
        }
        row.insertCell().innerHTML += '<input type="text" name="manufacture_day">';
        row.insertCell().innerHTML += '<input type="button" value="-" id="delButton" onclick="delDetail(this)">';
        // $(row).find('input[name=total]').attr('readonly', 'readonly').val(0);
        // $(row).find('input[type=number]').val(0);
    }


    // 해당 행 삭제 버튼
    function delDetail(row) {
        let tr = row.parentNode.parentNode;
        tr.parentNode.removeChild(tr);
    }
</script>

<!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
<script src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc="
        crossorigin="anonymous"></script>
<script
        src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
        crossorigin="anonymous"></script>
<!--<script th:src="@{/resources/js/req_js/add.js}"></script>-->
</body>
</html>


<!--
    지금 해야할 것.
    1. 발주코드 함수 불러와서 사용하기 => ajax를 통해서 발주등록 페이지 활성화 시 input안에 value 삽입
    2. 사용자가 입력한 영어를 대문자로 바꾸어주기 => upperCase 하면 될걸?
    3. 사이즈추가 버튼 활성화 -> 함수 만들기 => js
    4. 수량을 입력하면 총 수량에 합계 합산
    5. 단가 입력 시 수량*단가 = 총 금액 input 에 값 넣어주기

 -->