<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inven.mapper.OrderMapper">

    <!-- SQL -->

    <!--    예시용으로 나둔것   -->
    <sql id="titleColumn">
        product_code, gender, make_factory, unit_price, IFNULL(DATE(final_update), '-') AS final_update, make_code, product_status
    </sql>

    <sql id="searchCondition">
        WHERE product_code LIKE concat('%', #{productCode}, '%')
        <if test="!gender.equals('')">
            AND gender = #{gender}
        </if>
        <if test="!startDate.equals('') and !endDate.equals('')">
            AND DATE(final_update) BETWEEN DATE(#{startDate}) AND DATE(#{endDate})
        </if>
        <if test="!productStatus.equals('')">
            AND product_status = #{productStatus}
        </if>
    </sql>

    <!-- Select -->
    <select id="selectOrder" parameterType="string" resultType="com.inven.common.model.OrderManage">
        select * from order_manage
    </select>


<!--    예시용으로 나둔것   -->
    <select id="searchSelect" parameterType="com.inven.common.model.SearchParam" resultType="com.inven.common.model.ProductTitle">
        select <include refid="titleColumn"/>
        from product_title
        <include refid="searchCondition"/>
        ORDER BY input_date DESC
        LIMIT #{start_idx}, #{end_idx}
    </select>




    <!--    update    -->

<!--    예시용으로 나둔것   -->
    <update id="modColor" parameterType="java.util.List">
        <foreach collection="list" item="item" separator=";" close=";">
            UPDATE product_detail
            SET color_name = #{item.update_color_name}
            WHERE product_code = #{item.product_code} AND color_name = #{item.old_color_name}
        </foreach>
    </update>



</mapper>