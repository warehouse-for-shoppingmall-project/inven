<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inven.mapper.ProductMapper">

    <sql id="columns">
		*
	</sql>

    <select id="selectAll" parameterType="hashMap" resultType="hashmap">
        select
        <include refid="columns"/>
        from product_title pt
        join product_detail pd
        on pt.product_code = pd.product_code
    </select>

    <select id="detail" parameterType="com.inven.common.model.ProductDetail" resultType="com.inven.common.model.ProductDetail">
		select *
		from product_detail
	</select>

  <select id="searchByProductCode" parameterType="string" resultType="com.inven.common.model.ProductTitle">
    select *
    from product_title
    where product_code = #{query}
  </select>

  <select id="searchByDate" parameterType="string" resultType="com.inven.common.model.ProductTitle">
    select *
    from product_title
    where final_update = #{query}
  </select>

    <select id="modify" parameterType="string" resultMap="modifyMap" >
        select *
        from product_title
        join product_detail
        on product_title.product_code = #{productCode} and
        product_detail.product_code = #{productCode}
    </select>

  <resultMap id="modifyMap" type="com.inven.param.ProductInformation">
    <result property="product_code" column="product_code" />
    <result property="make_factory" column="make_factory" />
    <result property="unit_price" column="unit_price" />
    <result property="final_update" column="final_update" />
    <result property="make_code" column="make_code" />
    <result property="product_status" column="product_status" />
    <result property="color_name" column="color_name" />
    <result property="gender" column="gender" />
    <result property="s" column="s" />
    <result property="m" column="m" />
    <result property="l" column="l" />
    <result property="xl" column="xl" />
    <result property="f" column="f" />
    <result property="total" column="total" />
    <result property="manufacture_day" column="manufacture_day" />
  </resultMap>


  <!-- ADD -->
  <insert id="productTitlesAdd" parameterType="com.inven.common.model.ProductTitle">
    insert into product_title(product_code,
                              make_factory,
                              unit_price,
                              final_update,
                              make_code)
    values (#{product_code},
            #{make_factory}, #{unit_price},
            #{final_update}, #{make_code})
  </insert>

  <insert id="productDetailsAdd" parameterType="com.inven.common.model.ProductDetail">
    insert into product_detail(product_code,
                               color_name,
                               gender,
                               s,
                               m,
                               l,
                               xl,
                               f,
                               total,
                               manufacture_day)
    values (#{product_code}, #{color_name}, #{gender}, #{s}, #{m}, #{l}, #{xl}, #{f}, #{total},
            #{manufacture_day})
  </insert>

  <update id="upStatus" parameterType="com.inven.common.model.ProductTitle">
    UPDATE product_title
    SET product_status = #{product_status}
		WHERE product_code = #{product_code}
   </update>


</mapper>